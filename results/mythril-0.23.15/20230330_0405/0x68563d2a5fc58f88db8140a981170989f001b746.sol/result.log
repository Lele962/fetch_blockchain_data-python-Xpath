{"error": null, "issues": [{"address": 828, "code": "if( now >= openDate ) {\r\n            uint max = deposits[msg.sender];\r\n            if( amount <= max && max > 0 ) {\r\n                msg.sender.send( amount );\r\n                Withdrawal(msg.sender, amount);\r\n            }\r\n        }", "contract": "TimeCapsuleEvent", "description": "A control flow decision is made based on The block.timestamp environment variable.\nThe block.timestamp environment variable is used to determine a control flow decision. Note that the values of variables like coinbase, gaslimit, block number and timestamp are predictable and can be manipulated by a malicious miner. Also keep in mind that attackers know hashes of earlier blocks. Don't use any of those environment variables as sources of randomness and be aware that use of these variables introduces a certain level of trust into miners.", "filename": "/sb/0x68563d2a5fc58f88db8140a981170989f001b746.sol", "function": "withdraw(uint256)", "lineno": 45, "max_gas_used": 2273, "min_gas_used": 1848, "severity": "Low", "sourceMap": "1155:234", "swc-id": "116", "title": "Dependence on predictable environment variable", "tx_sequence": {"initialState": {"accounts": {"0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe": {"balance": "0x2158000120035802", "code": "", "nonce": 0, "storage": "{}"}, "0xdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef": {"balance": "0x0", "code": "", "nonce": 0, "storage": "{}"}}}, "steps": [{"address": "", "calldata": "", "input": "0x6080604052336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550610696806100536000396000f30060806040526004361061008e576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680632e1a7d4d1461009857806341c0e1b5146100b85780634fb2e45d146100cf578063b4a99a4e14610112578063b7f9c4f614610169578063d0e30db014610196578063ec8cb281146101a0578063fc7e286d146101cb575b610096610222565b005b6100b6600480360381019080803590602001909291905050506102da565b005b3480156100c457600080fd5b506100cd61041e565b005b3480156100db57600080fd5b50610110600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506104af565b005b34801561011e57600080fd5b50610127610569565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561017557600080fd5b506101946004803603810190808035906020019092919050505061058f565b005b61019e610222565b005b3480156101ac57600080fd5b506101b561064c565b6040518082815260200191505060405180910390f35b3480156101d757600080fd5b5061020c600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610652565b6040518082815260200191505060405180910390f35b6706f05b59d3b20000341015156102d35734600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055503373ffffffffffffffffffffffffffffffffffffffff167fe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c346040518082815260200191505060405180910390a26102d8565b600080fd5b565b60003373ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561041a576003544210151561041957600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905080821115801561038e5750600081115b15610418573373ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f19350505050503373ffffffffffffffffffffffffffffffffffffffff167f7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65836040518082815260200191505060405180910390a25b5b5b5050565b3373ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156104ad5760003073ffffffffffffffffffffffffffffffffffffffff163114156104ac573373ffffffffffffffffffffffffffffffffffffffff16ff5b5b565b3373ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156105665760003073ffffffffffffffffffffffffffffffffffffffff1631141561056557806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b5b50565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b33600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600381905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f25ff68dd81b34665b5ba7e553ee5511bf6812e12adb4a7e2c0d9e26b3099ce796003546040518082815260200191505060405180910390a250565b60035481565b600260205280600052604060002060009150905054815600a165627a7a72305820bca09dc8db322edfd35d1e241d41c8ec49133e57d7d7185f9a46e4a8df9a00920029", "name": "unknown", "origin": "0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe", "value": "0x0"}, {"address": "0x901d12ebe1b195e5aa8748e62bd7734ae19b51f", "calldata": "0x2e1a7d4d", "input": "0x2e1a7d4d", "name": "withdraw(uint256)", "origin": "0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe", "resolved_input": null, "value": "0x0"}]}}, {"address": 963, "code": "msg.sender.send( amount )", "contract": "TimeCapsuleEvent", "description": "The return value of a message call is not checked.\nExternal calls return a boolean value. If the callee halts with an exception, 'false' is returned and execution continues in the caller. The caller should check whether an exception happened and react accordingly to avoid unexpected behavior. For example it is often desirable to wrap external calls in require() so the transaction is reverted if the call fails.", "filename": "/sb/0x68563d2a5fc58f88db8140a981170989f001b746.sol", "function": "withdraw(uint256)", "lineno": 48, "max_gas_used": 40142, "min_gas_used": 4804, "severity": "Medium", "sourceMap": "1288:25", "swc-id": "104", "title": "Unchecked return value from external call.", "tx_sequence": {"initialState": {"accounts": {"0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe": {"balance": "0x41260324a0b80000", "code": "", "nonce": 0, "storage": "{}"}, "0xdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef": {"balance": "0x6600610ba390fb", "code": "", "nonce": 0, "storage": "{}"}}}, "steps": [{"address": "", "calldata": "", "input": "0x6080604052336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550610696806100536000396000f30060806040526004361061008e576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680632e1a7d4d1461009857806341c0e1b5146100b85780634fb2e45d146100cf578063b4a99a4e14610112578063b7f9c4f614610169578063d0e30db014610196578063ec8cb281146101a0578063fc7e286d146101cb575b610096610222565b005b6100b6600480360381019080803590602001909291905050506102da565b005b3480156100c457600080fd5b506100cd61041e565b005b3480156100db57600080fd5b50610110600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506104af565b005b34801561011e57600080fd5b50610127610569565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561017557600080fd5b506101946004803603810190808035906020019092919050505061058f565b005b61019e610222565b005b3480156101ac57600080fd5b506101b561064c565b6040518082815260200191505060405180910390f35b3480156101d757600080fd5b5061020c600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610652565b6040518082815260200191505060405180910390f35b6706f05b59d3b20000341015156102d35734600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055503373ffffffffffffffffffffffffffffffffffffffff167fe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c346040518082815260200191505060405180910390a26102d8565b600080fd5b565b60003373ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561041a576003544210151561041957600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905080821115801561038e5750600081115b15610418573373ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f19350505050503373ffffffffffffffffffffffffffffffffffffffff167f7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65836040518082815260200191505060405180910390a25b5b5b5050565b3373ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156104ad5760003073ffffffffffffffffffffffffffffffffffffffff163114156104ac573373ffffffffffffffffffffffffffffffffffffffff16ff5b5b565b3373ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156105665760003073ffffffffffffffffffffffffffffffffffffffff1631141561056557806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b5b50565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b33600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600381905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f25ff68dd81b34665b5ba7e553ee5511bf6812e12adb4a7e2c0d9e26b3099ce796003546040518082815260200191505060405180910390a250565b60035481565b600260205280600052604060002060009150905054815600a165627a7a72305820bca09dc8db322edfd35d1e241d41c8ec49133e57d7d7185f9a46e4a8df9a00920029", "name": "unknown", "origin": "0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe", "value": "0x0"}, {"address": "0x901d12ebe1b195e5aa8748e62bd7734ae19b51f", "calldata": "0xd0e30db0", "input": "0xd0e30db0", "name": "deposit()", "origin": "0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe", "resolved_input": null, "value": "0x6f05b59d3b20000"}, {"address": "0x901d12ebe1b195e5aa8748e62bd7734ae19b51f", "calldata": "0x2e1a7d4d", "input": "0x2e1a7d4d", "name": "withdraw(uint256)", "origin": "0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe", "resolved_input": null, "value": "0x0"}]}}], "success": true}
